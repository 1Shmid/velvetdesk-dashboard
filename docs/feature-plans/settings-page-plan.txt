# SETTINGS PAGE - IMPLEMENTATION PLAN

## üìã OVERVIEW
Settings page –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª–µ–º, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏, –ø–æ–¥–ø–∏—Å–∫–æ–π –∏ –∞–∫–∫–∞—É–Ω—Ç–æ–º.

---

## üóÑÔ∏è DATABASE CHANGES

### Update notification_settings table (Phase 1)
Current structure with boolean fields will be kept for Phase 1.
Future migration (Phase 2.5): Convert to preferences JSONB column or separate table.

Phase 1 notification types:
- New Call (email only)
- Booking Confirmed (email only)
- Booking Cancelled (email only)  
- Agent Settings Changed (email only)
- Billing Updates (email only)
- Marketing & News (email only)

Phase 2.5 expansion:
- Add SMS channel (via Twilio)
- Add WhatsApp channel (via WhatsApp Business API)
- Add Slack channel (via webhooks)
- Migrate to JSONB preferences column or notification_preferences table
```

### Update businesses table:
- Add: deleted_at TIMESTAMP (for soft delete)

---

## üéØ PAGE SECTIONS

1. **Profile Settings**
   - Business name (from businesses)
   - Contact name (from businesses)
   - Email (from users)
   - Change password (hash with bcrypt)

2. **Notifications**
   - Email notifications (from notification_settings)
   - SMS toggle (disabled for now)

3. **Subscription & Billing**
   - Status badge (from businesses.status)
   - Mock data: ‚Ç¨350/month, payment method, next billing
   - Link to LemonSqueezy portal (Phase 2)

4. **Danger Zone**
   - Soft delete: UPDATE businesses SET status = 'deleted', deleted_at = NOW()

---

## üîß API ENDPOINTS

- GET/PUT /api/profile - profile data
- PUT /api/password - change password
- GET/PUT /api/notifications - notification settings
- DELETE /api/account - soft delete account

---

## ‚úÖ DECISIONS

- Notifications: real DB implementation ‚úÖ
- Subscription: mock data + real UI ‚úÖ
- Delete: soft delete (status = 'deleted') ‚úÖ
- Notifications: Phase 1 = email only (6 types), Phase 2.5 = multi-channel ‚úÖ
- Billing: Phase 1 = mock UI, Phase 2 = LemonSqueezy API integration ‚úÖ
```


**Status:** Ready to implement
**Date:** 20 Oct 2025